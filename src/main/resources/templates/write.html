<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>글쓰기</title>
    <link rel="stylesheet" href="/default.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
    <script>
      $(document).ready(function() {
        $('#writeForm').submit(function(event) {
          event.preventDefault();

          var formData = {
            title: $('input[name="title"]').val(),
            contents: $('textarea[name="contents"]').val(),
            author: $('input[name="author"]').val(),
            password: $('input[name="password"]').val()
          };

          $.ajax({
            url: "/api/posts",
            type: "POST",
            data: JSON.stringify(formData),
            contentType: "application/json",
            success: function(response) {
              alert('글이 성공적으로 등록되었습니다.');
              window.location.href = '/board/list';
            },
            error: function(xhr, status, error) {
              alert('글 등록에 실패했습니다. 오류 메시지: ' + xhr.responseText);
              console.error('Error:', error);
            }
          });
        });
      });
    </script>
</head>
<body>
<div id="container">
  <h1>[ 게시판 - 글쓰기 ]</h1>
  <input type="button" onclick="location.href='/'" value="메인으로">
  <p>
  <form id="writeForm">
    <table>
      <tr>
        <th>제목</th>
        <td>
          <input type="text" name="title" required>
          <div class="error" id="titleError"></div>
        </td>
      </tr>
      <tr>
        <th>내용</th>
        <td>
          <textarea rows="10" cols="30" name="contents" required></textarea>
          <div class="error" id="contentsError"></div>
        </td>
      </tr>
      <tr>
        <th>작성자</th>
        <td>
          <input type="text" name="author" required>
        </td>
      </tr>
      <tr>
        <th>비밀번호</th>
        <td>
          <input type="password" name="password" required>
        </td>
      </tr>
    </table>
    
    <p>
    <div class="center">
      <input type="submit" value="등록하기">
      <input type="reset" value="취소">
    </div>
  </form>
</div>
</body>
</html>
